(function(g){g.wpProQuizFront=function(M,e){var b=g(M),d=this,h={},A={},V=0,k=null,p=[],W="",F=!1,N=1,X=0,Y=0,G=0,Z=0,H=0,O=0,P=0,w=0,$=0,q=0,aa=0,x=0,ba=0,I=0,Q=0,ca=0,R=0,da=0,S=0,ea=0,fa=0,ga=b.find('input[name="back"]'),y=b.find('input[name="next"]'),n=b.find(".wpProQuiz_quiz"),u=b.find(".wpProQuiz_list"),z=b.find(".wpProQuiz_results"),v=b.find(".wpProQuiz_text"),B=b.find(".wpProQuiz_time_limit"),J=b.find(".wpProQuiz_toplistShowInButton"),T=g(),ha="",U=0,ia=function(){var a=e.timelimit,c=0,b=
{stop:function(){a&&(window.clearInterval(c),B.hide())},start:function(){if(a){var f=1E3*a,m=B.find("span").text(d.methode.parseTime(a)),g=B.find(".wpProQuiz_progress");B.show();var e=+new Date;c=window.setInterval(function(){var a=+new Date-e,c=f-a;500<=a&&m.text(d.methode.parseTime(Math.ceil(c/1E3)));g.css("width",c/f*100+"%");0>=c&&(b.stop(),d.methode.finishQuiz(!0))},16)}}};return b}(),t=new function(){function a(a){var c="",b=C[a];b.review?c="#FFB800":b.solved&&(c="#6CA54C");h.eq(a).css("background-color",
c)}function c(a){a.preventDefault();a=a.pageY-K;0>a&&(a=0);a>k&&(a=k);e.attr("style","margin-top: "+-(D*a)+"px !important");m.css({top:a})}function l(a){a.preventDefault();g(document).unbind(".scrollEvent")}var f=[],m=[],e=[],h=[],k=0,K=0,D=0,L=0,s=0,C=[];this.init=function(){f=b.find(".wpProQuiz_reviewQuestion");m=f.find("div");e=f.find("ol");h=e.children();m.mousedown(function(a){a.preventDefault();a.stopPropagation();K=a.pageY-m.offset().top+L;g(document).bind("mouseup.scrollEvent",l);g(document).bind("mousemove.scrollEvent",
c)});h.click(function(a){d.methode.showQuestion(g(this).index())});b.bind("questionSolved",function(c){C[c.values.index].solved=c.values.solved;a(c.values.index)});b.bind("changeQuestion",function(a){h.removeClass("wpProQuiz_reviewQuestionTarget");h.eq(a.values.index).addClass("wpProQuiz_reviewQuestionTarget");a=h.eq(a.values.index);var c=a.offset().top,b=f.offset().top,c=c-b;if(0>c-4||100<c+32)a=b-h.eq(0).offset().top-(b-e.offset().top)+a.position().top,a>s&&(a=s),b=a/D,e.attr("style","margin-top: "+
-a+"px !important"),m.css({top:b})});b.bind("reviewQuestion",function(c){C[c.values.index].review=!C[c.values.index].review;a(c.values.index)});f.bind("mousewheel DOMMouseScroll",function(a){a.preventDefault();a=a.originalEvent;a=20*(a.wheelDelta?-a.wheelDelta/120:a.detail/3);a=L-e.offset().top+a;a>s&&(a=s);0>a&&(a=0);var c=a/D;e.attr("style","margin-top: "+-a+"px !important");m.css({top:c});return!1})};this.show=function(a){q&&f.parent().show();b.find(".wpProQuiz_reviewDiv .wpProQuiz_button2").show();
if(!a){e.attr("style","margin-top: 0px !important");m.css({top:0});a=e.outerHeight();var c=f.height();k=c-m.height();K=0;s=a-c;D=s/k;this.reset();100<a&&m.show();L=m.offset().top}};this.hide=function(){f.parent().hide()};this.toggle=function(){if(q){f.parent().toggle();h.removeClass("wpProQuiz_reviewQuestionTarget");b.find(".wpProQuiz_reviewDiv .wpProQuiz_button2").hide();e.attr("style","margin-top: 0px !important");m.css({top:0});var a=e.outerHeight(),c=f.height();k=c-m.height();K=0;s=a-c;D=s/k;
100<a&&m.show();L=m.offset().top}};this.reset=function(){for(var a=0,c=h.length;a<c;a++)C[a]={};h.removeClass("wpProQuiz_reviewQuestionTarget").css("background-color","")}},r=new function(){var a=0,c=-1,b=0,f=!1;this.questionStart=function(b){-1!=c&&this.questionStop();c=b;a=+new Date};this.questionStop=function(){-1!=c&&(h[c].time+=Math.round((new Date-a)/1E3),c=-1)};this.startQuiz=function(){f&&this.stopQuiz();b=+new Date;f=!0};this.stopQuiz=function(){f&&(h.comp.quizTime+=Math.round((new Date-
b)/1E3),f=!1)};this.init=function(){}},ja=function(a,c,b,f){var m=!0,e=0,h=g.isArray(c.points),k={};({singleMulti:function(){var a=f.find(".wpProQuiz_questionInput").attr("disabled","disabled"),b=c.diffMode;f.children().each(function(l){var f=g(this),k=f.data("pos");l=a.eq(l).is(":checked");c.correct[k]?(l?h&&(e=b?c.points[k]:e+c.points[k]):m=!1,c.disCorrect?m=!0:d.methode.marker(f,!0)):l?(c.disCorrect?m=!0:(d.methode.marker(f,!1),m=!1),b&&(e=c.points[k])):h&&!b&&(e+=c.points[k])})},sort_answer:function(){var a=
f.children();a.each(function(a,b){var l=g(this);k[a]=l.data("pos");a==l.data("pos")?(d.methode.marker(l,!0),h&&(e+=c.points[a])):(d.methode.marker(l,!1),m=!1)});a.children().css({"box-shadow":"0 0",cursor:"auto"});f.sortable("destroy");a.sort(function(a,c){return g(a).data("pos")>g(c).data("pos")?1:-1});f.append(a)},matrix_sort_answer:function(){var a=f.children(),n=[];k={0:-1};a.each(function(){var a=g(this),b=a.data("pos"),a=a.find(".wpProQuiz_maxtrixSortCriterion"),l=a.children();l.length&&(k[b]=
l.data("pos"));l.length&&0<=g.inArray(String(b),String(l.data("correct")).split(","))?(d.methode.marker(a,!0),h&&(e+=c.points[b])):(m=!1,d.methode.marker(a,!1));n[b]=a});d.methode.resetMatrix(b);b.find(".wpProQuiz_sortStringItem").each(function(){var a=n[g(this).data("pos")];void 0!=a&&a.append(this)}).css({"box-shadow":"0 0",cursor:"auto"});b.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable("destroy")},free_answer:function(){var a=f.children(),b=a.find(".wpProQuiz_questionInput").attr("disabled",
"disabled").val();0<=g.inArray(g.trim(b).toLowerCase(),c.correct)?d.methode.marker(a,!0):(d.methode.marker(a,!1),m=!1)},cloze_answer:function(){f.find(".wpProQuiz_cloze").each(function(a,b){var l=g(this).children(),f=l.eq(0),l=l.eq(1),k=d.methode.cleanupCurlyQuotes(f.val());0<=g.inArray(k,c.correct[a])?(h&&(e+=c.points[a]),G||f.css("background-color","#B0DAB0")):(G||f.css("background-color","#FFBABA"),m=!1,l.show());f.attr("disabled","disabled")})},assessment_answer:function(){m=!0;var a=0;f.find(".wpProQuiz_questionInput").attr("disabled",
"disabled").filter(":checked").each(function(){a+=parseInt(g(this).val())});e=a}})[a]();!h&&m&&(e=c.points);return{c:m,p:e,s:k}},E=new function(){var a={isEmpty:function(a){a=g.trim(a);return!a||0===a.length}};this.checkForm=function(){var c=!0;b.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var b=g(this),f=1==b.data("required"),e=b.data("type"),d=!0,h=g.trim(b.val());switch(e){case 0:case 1:case 7:f&&(d=
!a.isEmpty(h));break;case 2:if(f||!a.isEmpty(h))d=!a.isEmpty(h)&&!isNaN(h);break;case 4:if(f||!a.isEmpty(h))d=!a.isEmpty(h)&&(new RegExp(/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/)).test(h);break;case 3:f&&(d=b.is(":checked"));break;case 5:case 8:f&&(d=void 0!==b.find('input[type="radio"]:checked').val());break;case 6:var k=0,n=0;b.find("select").each(function(){k++;n+=a.isEmpty(g(this).val())?0:1});if(f||
0<n)d=k==n}d?b.siblings(".wpProQuiz_invalidate").hide():(c=!1,b.siblings(".wpProQuiz_invalidate").show())});return c};this.getFormData=function(){var a={};b.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var b=g(this),f=b.data("form_id");switch(b.data("type")){case 0:case 1:case 7:case 2:case 4:a[f]=b.val();break;case 3:a[f]=b.is(":checked")?1:0;break;case 5:case 8:a[f]=b.find('input[type="radio"]:checked').val();
break;case 6:a[f]={day:b.find('select[name="wpProQuiz_field_'+f+'_day"]').val(),month:b.find('select[name="wpProQuiz_field_'+f+'_month"]').val(),year:b.find('select[name="wpProQuiz_field_'+f+'_year"]').val()}}});return a}},ka=function(a){b.find(".wpProQuiz_questionList").each(function(){var c=g(this),b=c.data("question_id"),f=c.data("type"),e={};if("single"==f||"multiple"==f)c.find(".wpProQuiz_questionListItem").each(function(){e[g(this).data("pos")]=+g(this).find(".wpProQuiz_questionInput").is(":checked")});
else if("free_answer"==f)e[0]=c.find(".wpProQuiz_questionInput").val();else{if("sort_answer"==f||"matrix_sort_answer"==f)return!0;if("cloze_answer"==f){var d=0;c.find(".wpProQuiz_cloze input").each(function(){e[d++]=g(this).val()})}else"assessment_answer"==f&&(e[0]="",c.find(".wpProQuiz_questionInput:checked").each(function(){e[g(this).data("index")]=g(this).val()}))}a[b].data=e})};d.methode={parseBitOptions:function(){if(e.bo){X=e.bo&1;Y=e.bo&2;G=e.bo&4;Z=e.bo&8;H=e.bo&16;P=e.bo&64;q=e.bo&128;w=
e.bo&256;$=e.bo&512;aa=e.bo&1024;x=e.bo&2048;ba=e.bo&4096;I=e.bo&8192;Q=e.bo&16384;ca=e.bo&32768;var a=e.bo&32;a&&void 0!=jQuery.support&&void 0!=jQuery.support.cors&&0==jQuery.support.cors&&(O=a)}},setClozeStyle:function(){b.find(".wpProQuiz_cloze input").each(function(){for(var a=g(this),c="",b=a.data("wordlen"),f=0;f<b;f++)c+="w";c=g(document.createElement("span")).css("visibility","hidden").text(c).appendTo(g("body"));b=c.width();c.remove();a.width(b+5)})},parseTime:function(a){var c=parseInt(a%
60),b=parseInt(a/60%60);a=parseInt(a/3600%24);return(9<a?"":"0")+a+":"+((9<b?"":"0")+b)+":"+((9<c?"":"0")+c)},cleanupCurlyQuotes:function(a){a=a.replace(/\u2018/,"'");a=a.replace(/\u2019/,"'");a=a.replace(/\u201C/,'"');a=a.replace(/\u201D/,'"');return g.trim(a).toLowerCase()},resetMatrix:function(a){a.each(function(){var a=g(this),b=a.find(".wpProQuiz_sortStringList");a.find(".wpProQuiz_sortStringItem").each(function(){b.append(g(this))})})},marker:function(a,c){G||(c?a.addClass("wpProQuiz_answerCorrect"):
a.addClass("wpProQuiz_answerIncorrect"))},startQuiz:function(a){if(S)R=1;else if(R=0,da)v.hide(),b.find(".wpProQuiz_lock").show();else if(ea)v.hide(),b.find(".wpProQuiz_prerequisite").show();else if(fa)v.hide(),b.find(".wpProQuiz_startOnlyRegisteredUser").show();else if(Q&&!a)v.hide(),b.find(".wpProQuiz_loadQuiz").show(),d.methode.loadQuizDataAjax(!0);else if(!I||0!=e.formPos||E.checkForm()){d.methode.loadQuizData();Y&&d.methode.random(u);X&&d.methode.random(b.find(".wpProQuiz_questionList"));ca&&
d.methode.sortCategories();d.methode.random(b.find(".wpProQuiz_sortStringList"));d.methode.random(b.find('[data-type="sort_answer"]'));b.find(".wpProQuiz_listItem").each(function(a,b){var f=g(this);f.find(".wpProQuiz_question_page span:eq(0)").text(a+1);f.find("> h5 span").text(a+1);f.find(".wpProQuiz_questionListItem").each(function(a,b){g(this).find("> span:not(.wpProQuiz_cloze)").text(a+1+". ")})});y=b.find('input[name="next"]');switch(e.mode){case 3:b.find('input[name="checkSingle"]').show();
break;case 2:b.find('input[name="check"]').show();!$&&q&&b.find('input[name="skip"]').show();break;case 1:b.find('input[name="back"]').slice(1).show();case 0:y.show()}(ba||3==e.mode)&&b.find(".wpProQuiz_question_page").hide();a=y.last();W=a.val();a.val(e.lbn);a=u.children();T=b.find(".wpProQuiz_list > li");3==e.mode?d.methode.showSinglePage(0):(k=a.eq(0).show(),a=k.find(".wpProQuiz_questionList").data("question_id"),r.questionStart(a));r.startQuiz();b.find(".wpProQuiz_sortable").parents("ul").sortable({update:function(a,
e){var f=g(this).parents(".wpProQuiz_listItem");b.trigger({type:"questionSolved",values:{item:f,index:f.index(),solved:!0}})}}).disableSelection();b.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable({connectWith:".wpProQuiz_maxtrixSortCriterion:not(:has(li)), .wpProQuiz_sortStringList",placeholder:"wpProQuiz_placehold",update:function(a,e){var f=g(this).parents(".wpProQuiz_listItem");b.trigger({type:"questionSolved",values:{item:f,index:f.index(),solved:!0}})}}).disableSelection();
p=[];ia.start();V=+new Date;h={comp:{points:0,correctQuestions:0,quizTime:0}};b.find(".wpProQuiz_questionList").each(function(){var a=g(this).data("question_id");h[a]={time:0,solved:0}});A={};g.each(e.catPoints,function(a,b){A[a]=0});v.hide();b.find(".wpProQuiz_loadQuiz").hide();n.show();t.show();3!=e.mode&&b.trigger({type:"changeQuestion",values:{item:k,index:k.index()}})}},showSingleQuestion:function(a){a=a?Math.ceil(a/e.qpp):1;this.showSinglePage(a)},showSinglePage:function(a){$listItem=u.children().hide();
if(e.qpp){a=a?+a:1;var c=Math.ceil(b.find(".wpProQuiz_list > li").length/e.qpp);if(!(a>c)){var l=b.find('input[name="wpProQuiz_pageLeft"]').hide(),f=b.find('input[name="wpProQuiz_pageRight"]').hide(),g=b.find('input[name="checkSingle"]').hide();1<a&&l.val(l.data("text").replace(/%d/,a-1)).show();a==c?g.show():f.val(f.data("text").replace(/%d/,a+1)).show();N=a;a=e.qpp*(a-1);$listItem.slice(a,a+e.qpp).show();d.methode.scrollTo(n)}}else $listItem.show()},nextQuestion:function(){this.showQuestionObject(k.next())},
prevQuestion:function(){this.showQuestionObject(k.prev())},showQuestion:function(a){var b=T.eq(a);3==e.mode||F?(e.qpp&&d.methode.showSingleQuestion(a+1),d.methode.scrollTo(b,1),r.startQuiz()):this.showQuestionObject(b)},showQuestionObject:function(a){if(!a.length&&x&&w&&q)for(var c=0,e=b.find(".wpProQuiz_listItem").length;c<e;c++)if(!p[c])return alert(WpProQuizGlobal.questionsNotSolved),!1;k.hide();k=a.show();d.methode.scrollTo(n);b.trigger({type:"changeQuestion",values:{item:k,index:k.index()}});
k.length?(a=k.find(".wpProQuiz_questionList").data("question_id"),r.questionStart(a)):d.methode.showQuizSummary()},skipQuestion:function(){b.trigger({type:"skipQuestion",values:{item:k,index:k.index()}});d.methode.nextQuestion()},reviewQuestion:function(){b.trigger({type:"reviewQuestion",values:{item:k,index:k.index()}})},showQuizSummary:function(){r.questionStop();r.stopQuiz();if(w||!q)I&&1==e.formPos?(t.hide(),n.hide(),d.methode.scrollTo(b.find(".wpProQuiz_infopage").show())):d.methode.finishQuiz();
else{var a=b.find(".wpProQuiz_checkPage");a.find("ol:eq(0)").empty().append(b.find(".wpProQuiz_reviewQuestion ol li").clone().removeClass("wpProQuiz_reviewQuestionTarget")).children().click(function(b){a.hide();n.show();t.show(!0);d.methode.showQuestion(g(this).index())});for(var c=0,l=0,f=p.length;l<f;l++)p[l]&&c++;a.find("span:eq(0)").text(c);t.hide();n.hide();a.show();d.methode.scrollTo(a)}},finishQuiz:function(a){r.questionStop();r.stopQuiz();ia.stop();var c=(+new Date-V)/1E3,c=e.timelimit&&c>
e.timelimit?e.timelimit:c;b.find(".wpProQuiz_quiz_time span").text(d.methode.parseTime(c));a&&z.find(".wpProQuiz_time_limit_expired").show();d.methode.checkQuestion(u.children(),!0);b.find(".wpProQuiz_correct_answer").text(h.comp.correctQuestions);h.comp.result=Math.round(h.comp.points/e.globalPoints*1E4)/100;h.comp.solved=0;a=b.find(".wpProQuiz_points span");a.eq(0).text(h.comp.points);a.eq(1).text(e.globalPoints);a.eq(2).text(h.comp.result+"%");a=b.find(".wpProQuiz_resultsList > li").eq(d.methode.findResultIndex(h.comp.result));
var l=E.getFormData();a.find(".wpProQuiz_resultForm").each(function(){var a=g(this),b=a.data("form_id"),b=l[b];"object"===typeof b&&(b=b.day+"-"+b.month+"-"+b.year);a.text(b).show()});a.show();d.methode.setAverageResult(h.comp.result,!1);this.setCategoryOverview();d.methode.sendCompletedQuiz();P&&U&&d.methode.addToplist();t.hide();b.find(".wpProQuiz_checkPage, .wpProQuiz_infopage").hide();n.hide();z.show();d.methode.scrollTo(z)},setCategoryOverview:function(){h.comp.cats={};b.find(".wpProQuiz_catOverview li").each(function(){var a=
g(this),b=a.data("category_id");if(void 0===e.catPoints[b])return a.hide(),!0;var d=Math.round(A[b]/e.catPoints[b]*1E4)/100;h.comp.cats[b]=d;a.find(".wpProQuiz_catPercent").text(d+"%");a.show()})},questionSolved:function(a){p[a.values.index]=a.values.solved;var b=a.values.item.find(".wpProQuiz_questionList"),b=e.json[b.data("question_id")];h[b.id].solved=Number(a.values.fake?h[b.id].solved:a.values.solved)},sendCompletedQuiz:function(){if(!H){ka(h);var a=E.getFormData();d.methode.ajax({action:"wp_pro_quiz_completed_quiz",
quizId:e.quizId,results:h,forms:a})}},findResultIndex:function(a){for(var b=e.resultsGrade,d=-1,f=999999,g=0;g<b.length;g++){var h=b[g];a>=h&&a-h<f&&(f=a-h,d=g)}return d},showQustionList:function(){F=!F;J.hide();n.toggle();b.find(".wpProQuiz_QuestionButton").hide();u.children().show();t.toggle();b.find(".wpProQuiz_question_page").hide()},random:function(a){a.each(function(){var a=g(this).children().get().sort(function(){return Math.round(Math.random())-.5});g(a).appendTo(a[0].parentNode)})},sortCategories:function(){var a=
g(".wpProQuiz_list").children().get().sort(function(a,b){var f=g(a).find(".wpProQuiz_questionList").data("question_id"),d=g(b).find(".wpProQuiz_questionList").data("question_id");return e.json[f].catId-e.json[d].catId});g(a).appendTo(a[0].parentNode)},restartQuiz:function(){z.hide();v.show();u.children().hide();J.hide();t.hide();b.find(".wpProQuiz_questionInput, .wpProQuiz_cloze input").removeAttr("disabled").removeAttr("checked").css("background-color","");b.find('.wpProQuiz_questionListItem input[type="text"]').val("");
b.find(".wpProQuiz_answerCorrect, .wpProQuiz_answerIncorrect").removeClass("wpProQuiz_answerCorrect wpProQuiz_answerIncorrect");b.find(".wpProQuiz_listItem").data("check",!1);b.find(".wpProQuiz_response").hide().children().hide();d.methode.resetMatrix(b.find(".wpProQuiz_listItem"));b.find(".wpProQuiz_sortStringItem, .wpProQuiz_sortable").removeAttr("style");b.find(".wpProQuiz_clozeCorrect, .wpProQuiz_QuestionButton, .wpProQuiz_resultsList > li").hide();b.find('.wpProQuiz_question_page, input[name="tip"]').show();
b.find(".wpProQuiz_resultForm").text("").hide();z.find(".wpProQuiz_time_limit_expired").hide();y.last().val(W);F=!1},checkQuestion:function(a,c){a=void 0==a?k:a;a.each(function(){var a=g(this),f=a.find(".wpProQuiz_questionList"),d=e.json[f.data("question_id")],k=d.type;r.questionStop();if(a.data("check"))return!0;if("single"==d.type||"multiple"==d.type)k="singleMulti";f=ja(k,d,a,f);a.find(".wpProQuiz_response").show();a.find('input[name="check"]').hide();a.find('input[name="skip"]').hide();a.find('input[name="next"]').show();
h[d.id].points=f.p;h[d.id].correct=Number(f.c);h[d.id].data=f.s;h.comp.points+=f.p;A[d.catId]+=f.p;f.c?(a.find(".wpProQuiz_correct").show(),h.comp.correctQuestions+=1):a.find(".wpProQuiz_incorrect").show();a.find(".wpProQuiz_responsePoints").text(f.p);a.data("check",!0);c||b.trigger({type:"questionSolved",values:{item:a,index:a.index(),solved:!0,fake:!0}})})},showTip:function(){var a=g(this),c=a.siblings(".wpProQuiz_question").find(".wpProQuiz_questionList").data("question_id");a.siblings(".wpProQuiz_tipp").toggle("fast");
h[c].tip=1;g(document).bind("mouseup.tipEvent",function(a){var c=b.find(".wpProQuiz_tipp"),d=b.find('input[name="tip"]');c.is(a.target)||0!=c.has(a.target).length||d.is(a.target)||(c.hide("fast"),g(document).unbind(".tipEvent"))})},ajax:function(a,b,d){O&&(jQuery.support.cors=!0);g.post(WpProQuizGlobal.ajaxurl,a,b,d||"json");O&&(jQuery.support.cors=!1)},checkQuizLock:function(){S=1;d.methode.ajax({action:"wp_pro_quiz_check_lock",quizId:e.quizId},function(a){void 0!=a.lock&&(da=a.lock.is,a.lock.pre&&
b.find('input[name="restartQuiz"]').hide());void 0!=a.prerequisite&&(ea=1,b.find(".wpProQuiz_prerequisite span").text(a.prerequisite));void 0!=a.startUserLock&&(fa=a.startUserLock);S=0;R&&d.methode.startQuiz()})},loadQuizData:function(){d.methode.ajax({action:"wp_pro_quiz_load_quiz_data",quizId:e.quizId},function(a){a.toplist&&d.methode.handleToplistData(a.toplist);void 0!=a.averageResult&&d.methode.setAverageResult(a.averageResult,!0)})},setAverageResult:function(a,c){var d=b.find(".wpProQuiz_resultValue:eq("+
(c?0:1)+") > * ");d.eq(1).text(a+"%");d.eq(0).css("width",240*a/100+"px")},handleToplistData:function(a){var c=b.find(".wpProQuiz_addToplist"),d=c.find(".wpProQuiz_addBox").show().children("div");a.canAdd?(c.show(),c.find(".wpProQuiz_addToplistMessage").hide(),c.find(".wpProQuiz_toplistButton").show(),ha=a.token,U=0,a.userId?(d.hide(),U=1,P&&c.hide()):(d.show(),c=d.children().eq(1),a.captcha?(c.find('input[name="wpProQuiz_captchaPrefix"]').val(a.captcha.code),c.find(".wpProQuiz_captchaImg").attr("src",
a.captcha.img),c.find('input[name="wpProQuiz_captcha"]').val(""),c.show()):c.hide())):c.hide()},scrollTo:function(a,b){var d=a.offset().top-100;(b||(window.pageYOffset||document.body.scrollTop)>d)&&g("html,body").animate({scrollTop:d},300)},addToplist:function(){if(!H){var a=b.find(".wpProQuiz_addToplistMessage").text(WpProQuizGlobal.loadData).show(),c=b.find(".wpProQuiz_addBox").hide();d.methode.ajax({action:"wp_pro_quiz_add_toplist",quizId:e.quizId,token:ha,name:c.find('input[name="wpProQuiz_toplistName"]').val(),
email:c.find('input[name="wpProQuiz_toplistEmail"]').val(),captcha:c.find('input[name="wpProQuiz_captcha"]').val(),prefix:c.find('input[name="wpProQuiz_captchaPrefix"]').val(),points:h.comp.points,totalPoints:e.globalPoints},function(b){a.text(b.text);b.clear?(c.hide(),d.methode.updateToplist()):c.show();b.captcha&&(c.find(".wpProQuiz_captchaImg").attr("src",b.captcha.img),c.find('input[name="wpProQuiz_captchaPrefix"]').val(b.captcha.code),c.find('input[name="wpProQuiz_captcha"]').val(""))})}},updateToplist:function(){"function"==
typeof wpProQuiz_fetchToplist&&wpProQuiz_fetchToplist()},registerSolved:function(){b.find('.wpProQuiz_questionInput[type="text"]').change(function(a){a=g(this);var c=a.parents(".wpProQuiz_listItem"),d=!1;""!=a.val()&&(d=!0);b.trigger({type:"questionSolved",values:{item:c,index:c.index(),solved:d}})});b.find('.wpProQuiz_questionList[data-type="single"] .wpProQuiz_questionInput, .wpProQuiz_questionList[data-type="assessment_answer"] .wpProQuiz_questionInput').change(function(a){a=g(this).parents(".wpProQuiz_listItem");
var c=this.checked;b.trigger({type:"questionSolved",values:{item:a,index:a.index(),solved:c}})});b.find(".wpProQuiz_cloze input").change(function(){var a=g(this).parents(".wpProQuiz_listItem"),c=!0;a.find(".wpProQuiz_cloze input").each(function(){if(""==g(this).val())return c=!1});b.trigger({type:"questionSolved",values:{item:a,index:a.index(),solved:c}})});b.find('.wpProQuiz_questionList[data-type="multiple"] .wpProQuiz_questionInput').change(function(a){a=g(this).parents(".wpProQuiz_listItem");
var c=0;a.find('.wpProQuiz_questionList[data-type="multiple"] .wpProQuiz_questionInput').each(function(a){this.checked&&c++});b.trigger({type:"questionSolved",values:{item:a,index:a.index(),solved:c?!0:!1}})})},loadQuizDataAjax:function(a){d.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"quizLoadData",data:{quizId:e.quizId}},function(c){e.globalPoints=c.globalPoints;e.catPoints=c.catPoints;e.json=c.json;n.remove();b.find(".wpProQuiz_quizAnker").after(c.content);ga=b.find('input[name="back"]');
y=b.find('input[name="next"]');n=b.find(".wpProQuiz_quiz");u=b.find(".wpProQuiz_list");z=b.find(".wpProQuiz_results");v=b.find(".wpProQuiz_text");B=b.find(".wpProQuiz_time_limit");J=b.find(".wpProQuiz_toplistShowInButton");T=g();d.methode.initQuiz();a&&d.methode.startQuiz(!0)})},initQuiz:function(){d.methode.setClozeStyle();d.methode.registerSolved();y.click(function(){if(x&&!p[k.index()]&&(w||!q))return alert(WpProQuizGlobal.questionNotSolved),!1;d.methode.nextQuestion()});ga.click(function(){d.methode.prevQuestion()});
b.find('input[name="check"]').click(function(){if(x&&!p[k.index()]&&(w||!q))return alert(WpProQuizGlobal.questionNotSolved),!1;d.methode.checkQuestion()});b.find('input[name="checkSingle"]').click(function(){if(x&&(w||!q))for(var a=0,c=b.find(".wpProQuiz_listItem").length;a<c;a++)if(!p[a])return alert(WpProQuizGlobal.questionsNotSolved),!1;d.methode.showQuizSummary()});b.find('input[name="tip"]').click(d.methode.showTip);b.find('input[name="skip"]').click(d.methode.skipQuestion);b.find('input[name="wpProQuiz_pageLeft"]').click(function(){d.methode.showSinglePage(N-
1)});b.find('input[name="wpProQuiz_pageRight"]').click(function(){d.methode.showSinglePage(N+1)})}};d.preInit=function(){d.methode.parseBitOptions();t.init();b.find('input[name="startQuiz"]').click(function(){d.methode.startQuiz();return!1});Z&&!H&&d.methode.checkQuizLock();b.find('input[name="reShowQuestion"]').click(function(){d.methode.showQustionList()});b.find('input[name="restartQuiz"]').click(function(){d.methode.restartQuiz()});b.find('input[name="review"]').click(d.methode.reviewQuestion);
b.find('input[name="wpProQuiz_toplistAdd"]').click(d.methode.addToplist);b.find('input[name="quizSummary"]').click(d.methode.showQuizSummary);b.find('input[name="endQuizSummary"]').click(function(){if(x)for(var a=0,c=b.find(".wpProQuiz_listItem").length;a<c;a++)if(!p[a])return alert(WpProQuizGlobal.questionsNotSolved),!1;I&&1==e.formPos&&!E.checkForm()||d.methode.finishQuiz()});b.find('input[name="endInfopage"]').click(function(){E.checkForm()&&d.methode.finishQuiz()});b.find('input[name="showToplist"]').click(function(){n.hide();
J.toggle()});b.bind("questionSolved",d.methode.questionSolved);Q||d.methode.initQuiz();aa&&d.methode.startQuiz()};d.preInit()};g.fn.wpProQuizFront=function(M){return this.each(function(){void 0==g(this).data("wpProQuizFront")&&g(this).data("wpProQuizFront",new g.wpProQuizFront(this,M))})}})(jQuery);
